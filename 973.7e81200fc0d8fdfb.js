"use strict";(self.webpackChunkpolenmad=self.webpackChunkpolenmad||[]).push([[973],{9973:(Oe,A,s)=>{s.r(A),s.d(A,{MetricsPageModule:()=>Ie});var p=s(9808),h=s(7288),z=s(8138),c=s(655),T=s(9751);let I=(()=>{class t{}return t.type="[Metrics] Retrieve Metrics",t})();var L=s(8953),P=s(8505),R=s(1082),e=s(5e3);let u=class{constructor(r){this.metricsService=r}static metrics(r){return r.metrics}static alergies(r,n){const i=new Map([["very_high",0],["high",1],["medium",2],["low",3]]),l=n.pollenTypes.filter(a=>a.active).map(a=>a.type);return r.metrics.entries.filter(a=>l.includes(a.value.type)).sort((a,g)=>{var d,f;return(null!==(d=i.get(a.value.polllenGrains.level))&&void 0!==d?d:3)-(null!==(f=i.get(g.value.polllenGrains.level))&&void 0!==f?f:3)})}retrieveMetrics(r,n){return this.metricsService.getMetrics().pipe((0,P.b)(i=>{r.patchState({metrics:i})}))}};u.\u0275fac=function(r){return new(r||u)(e.LFG(L.KH))},u.\u0275prov=e.Yz7({token:u,factory:u.\u0275fac}),(0,c.gn)([(0,h.aU)(I),(0,c.w6)("design:type",Function),(0,c.w6)("design:paramtypes",[Object,I]),(0,c.w6)("design:returntype",void 0)],u.prototype,"retrieveMetrics",null),(0,c.gn)([(0,h.Qf)(),(0,c.w6)("design:type",Function),(0,c.w6)("design:paramtypes",[Object]),(0,c.w6)("design:returntype",void 0)],u,"metrics",null),(0,c.gn)([(0,h.Qf)([R.$]),(0,c.w6)("design:type",Function),(0,c.w6)("design:paramtypes",[Object,Object]),(0,c.w6)("design:returntype",void 0)],u,"alergies",null),u=(0,c.gn)([(0,h.ZM)({name:"metrics",defaults:{metrics:{lastUpdated:0,entries:[]}}}),(0,c.w6)("design:paramtypes",[L.KH])],u);var y=s(9177),o=s(2014),v=s(8923);const N=["*"];let Z=(()=>{let t=class{constructor(){this.size="m",this.textAlign="left",this.hoverable=!1,this.transparent=!1}get sizeS(){return"s"===this.size}get sizeM(){return"m"===this.size}get sizeL(){return"l"===this.size}get textAlignLeft(){return"left"===this.textAlign}get textAlignCenter(){return"center"===this.textAlign}get textAlignRight(){return"right"===this.textAlign}};return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["tui-island"],["a","tuiIsland",""]],hostAttrs:[1,"tui-island"],hostVars:16,hostBindings:function(n,i){2&n&&e.ekj("tui-island_hoverable",i.hoverable)("tui-island_transparent",i.transparent)("tui-island_size_s",i.sizeS)("tui-island_size_m",i.sizeM)("tui-island_size_l",i.sizeL)("tui-island_text-align_left",i.textAlignLeft)("tui-island_text-align_center",i.textAlignCenter)("tui-island_text-align_right",i.textAlignRight)},inputs:{size:"size",textAlign:"textAlign",hoverable:"hoverable",transparent:"transparent"},ngContentSelectors:N,decls:1,vars:0,template:function(n,i){1&n&&(e.F$t(),e.Hsn(0))},styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0}),(0,o.gn)([(0,e.IIB)(),(0,v.TH)()],t.prototype,"size",void 0),(0,o.gn)([(0,e.IIB)(),(0,v.TH)()],t.prototype,"textAlign",void 0),(0,o.gn)([(0,e.IIB)(),(0,e.pfw)("class.tui-island_hoverable"),(0,v.TH)()],t.prototype,"hoverable",void 0),(0,o.gn)([(0,e.IIB)(),(0,e.pfw)("class.tui-island_transparent"),(0,v.TH)()],t.prototype,"transparent",void 0),(0,o.gn)([(0,e.pfw)("class.tui-island_size_s")],t.prototype,"sizeS",null),(0,o.gn)([(0,e.pfw)("class.tui-island_size_m")],t.prototype,"sizeM",null),(0,o.gn)([(0,e.pfw)("class.tui-island_size_l")],t.prototype,"sizeL",null),(0,o.gn)([(0,e.pfw)("class.tui-island_text-align_left")],t.prototype,"textAlignLeft",null),(0,o.gn)([(0,e.pfw)("class.tui-island_text-align_center")],t.prototype,"textAlignCenter",null),(0,o.gn)([(0,e.pfw)("class.tui-island_text-align_right")],t.prototype,"textAlignRight",null),t})(),H=(()=>{let t=class{};return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[p.ez]]}),t})();var J=s(9040),_=s(3099),Y=s(9892);const O=new e.OlP("Root element for IntersectionObserver"),V=new e.OlP("rootMargin for IntersectionObserver",{providedIn:"root",factory:()=>"0px 0px 0px 0px"}),j=new e.OlP("threshold for IntersectionObserver",{providedIn:"root",factory:()=>0}),K=new e.OlP("Intersection Observer API support",{providedIn:"root",factory:()=>!!(0,e.f3M)(Y.m9).IntersectionObserver});let x=(()=>{class t extends T.y{constructor({nativeElement:n},i,l,a,g){return super(d=>{if(!i)return void d.error("IntersectionObserver is not supported in your browser");const f=new IntersectionObserver(M=>{d.next(M)},{root:g&&g.nativeElement,rootMargin:l,threshold:a});return f.observe(n),()=>{f.disconnect()}}),this.pipe((0,_.B)())}}return t.\u0275fac=function(n){return new(n||t)(e.LFG(e.SBq),e.LFG(K),e.LFG(V),e.LFG(j),e.LFG(O,8))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac}),t})();var X=s(3679),C=s(7776),W=s(9646),q=s(7579),ee=s(3900),te=s(9300),ne=s(9718),re=s(262),ie=s(5698),oe=s(2722);let b=(()=>{let t=class extends T.y{constructor(n,i,l){super(a=>this.src$.pipe((0,ee.w)(g=>l.pipe((0,te.h)(([{isIntersecting:d}])=>d),(0,ne.h)(g),(0,re.K)(()=>(0,W.of)(g)),(0,X.YP)(n),(0,ie.q)(1))),(0,oe.R)(i)).subscribe(a)),this.src$=new q.x}next(n){this.src$.next(n)}};return t.\u0275fac=function(n){return new(n||t)(e.LFG(e.sBO),e.LFG(C.a3),e.LFG(x))},t.\u0275prov=e.Yz7({token:t,factory:function(r){return t.\u0275fac(r)}}),t=(0,o.gn)([(0,o.fM)(0,(0,e.tBr)(e.sBO)),(0,o.fM)(1,(0,e.tBr)(C.a3)),(0,o.fM)(2,(0,e.tBr)(x))],t),t})(),se=(()=>{let t=class{constructor(n,i){this.src$=n,this.elementRef=i,this.animation="tuiSkeletonVibe ease-in-out 1s infinite alternate",this.background="rgba(0, 0, 0, .16)",this.src=null,this.supported||this.src$.subscribe(l=>{this.src=l})}set srcSetter(n){this.src=this.supported?n:null,this.src$.next(n)}get supported(){return"loading"in this.elementRef.nativeElement}onLoad(){this.background="",this.animation=""}};return t.\u0275fac=function(n){return new(n||t)(e.Y36(b),e.Y36(e.SBq))},t.\u0275dir=e.lG2({type:t,selectors:[["img","loading","lazy"]],hostVars:5,hostBindings:function(n,i){1&n&&e.NdJ("load",function(){return i.onLoad()}),2&n&&(e.uIk("src",i.src,e.LSH),e.Udp("animation",i.animation)("background",i.background))},inputs:{srcSetter:["src","srcSetter"]},features:[e._Bn([b,x,C.a3])]}),(0,o.gn)([(0,e.IIB)("src")],t.prototype,"srcSetter",null),(0,o.gn)([(0,e.pfw)("style.animation")],t.prototype,"animation",void 0),(0,o.gn)([(0,e.pfw)("style.background")],t.prototype,"background",void 0),(0,o.gn)([(0,e.pfw)("attr.src")],t.prototype,"src",void 0),(0,o.gn)([(0,e.L6J)("load")],t.prototype,"onLoad",null),t=(0,o.gn)([(0,o.fM)(0,(0,e.tBr)(b)),(0,o.fM)(1,(0,e.tBr)(e.SBq))],t),t})(),ae=(()=>{let t=class{};return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({}),t})();function ce(t,r){if(1&t){const n=e.EpF();e.TgZ(0,"img",2),e.NdJ("error",function(){return e.CHM(n),e.oxw().onError()}),e.qZA()}if(2&t){const n=e.oxw();e.Q6J("src",n.avatarUrl,e.LSH),e.uIk("alt",n.text)}}let le=(()=>{let t=class{constructor(){this.size="m",this.text="",this.autoColor=!1,this.rounded=!1,this.avatarUrl=null,this.isUrlValid=!1}set avatarUrlSetter(n){this.isUrlValid=!!n,this.avatarUrl=n}get bgColor(){return this.autoColor?function G(t){if(""===t)return"";let r=0;for(let a=0;a<t.length;a++)r=t.charCodeAt(a)+((r<<5)-r),r&=r;return`hsl(${r%360},${60+r%5}%,${80+r%5}%)`}(this.text):""}get hasAvatar(){return null!==this.avatarUrl&&this.isUrlValid}get computedText(){if(this.hasAvatar||""===this.text)return"";const n=this.text.split(" ");return n.length>1&&(0,J.Bb)(this.size)?n[0].substr(0,1)+n[1].substr(0,1):n[0].substr(0,1)}onError(){this.isUrlValid=!1}};return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["tui-avatar"]],hostVars:7,hostBindings:function(n,i){2&n&&(e.uIk("data-tui-host-size",i.size),e.Udp("background",i.bgColor),e.ekj("_rounded",i.rounded)("_has-avatar",i.hasAvatar))},inputs:{size:"size",text:"text",autoColor:"autoColor",rounded:"rounded",avatarUrlSetter:["avatarUrl","avatarUrlSetter"]},decls:3,vars:2,consts:[["loading","lazy","class","image",3,"src","error",4,"ngIf"],[1,"text"],["loading","lazy",1,"image",3,"src","error"]],template:function(n,i){1&n&&(e.YNc(0,ce,1,2,"img",0),e.TgZ(1,"span",1),e._uU(2),e.qZA()),2&n&&(e.Q6J("ngIf",i.isUrlValid),e.xp6(2),e.Oqu(i.computedText))},directives:[p.O5,se],styles:["[_nghost-%COMP%]{position:relative;display:flex;flex-shrink:0;border-radius:var(--tui-radius-m);color:var(--tui-secondary-active);text-align:center;text-transform:uppercase;justify-content:center;align-items:center;background-color:currentColor;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;overflow:hidden}[data-tui-host-size=xs][_nghost-%COMP%]{font:var(--tui-font-text-s);width:1.5rem;height:1.5rem}[data-tui-host-size='s'][_nghost-%COMP%]{font:var(--tui-font-text-m);width:2rem;height:2rem}[data-tui-host-size='m'][_nghost-%COMP%]{font:var(--tui-font-text-l);width:3rem;height:3rem}[data-tui-host-size='l'][_nghost-%COMP%]{font:var(--tui-font-heading-5);width:4rem;height:4rem;border-radius:var(--tui-radius-l)}[data-tui-host-size=xl][_nghost-%COMP%]{font:var(--tui-font-heading-3);width:6rem;height:6rem;border-radius:var(--tui-radius-l)}[data-tui-host-size=xxl][_nghost-%COMP%]{font:var(--tui-font-heading-1);width:9rem;height:9rem;border-radius:var(--tui-radius-l)}._has-avatar[_nghost-%COMP%]{background-color:transparent}._rounded[_nghost-%COMP%]{border-radius:100%}.image[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.text[_ngcontent-%COMP%]{color:var(--tui-text-01)}"],changeDetection:0}),(0,o.gn)([(0,e.IIB)(),(0,e.pfw)("attr.data-tui-host-size"),(0,v.TH)()],t.prototype,"size",void 0),(0,o.gn)([(0,e.IIB)("avatarUrl"),(0,v.NH)()],t.prototype,"avatarUrlSetter",null),(0,o.gn)([(0,e.IIB)(),(0,v.TH)()],t.prototype,"text",void 0),(0,o.gn)([(0,e.IIB)(),(0,v.TH)()],t.prototype,"autoColor",void 0),(0,o.gn)([(0,e.IIB)(),(0,e.pfw)("class._rounded"),(0,v.TH)()],t.prototype,"rounded",void 0),(0,o.gn)([(0,e.pfw)("style.background")],t.prototype,"bgColor",null),(0,o.gn)([(0,e.pfw)("class._has-avatar")],t.prototype,"hasAvatar",null),t})(),ue=(()=>{let t=class{};return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[p.ez,ae]]}),t})();var E=s(3675);const de=new Map([["very_high","POLLEN_LEVEL__VERY_HIGH"],["high","POLLEN_LEVEL__HIGH"],["medium","POLLEN_LEVEL__MEDIUM"],["low","POLLEN_LEVEL__LOW"]]);let B=(()=>{class t{constructor(n){this.transloco=n}transform(n){const i=de.get(n)||"POLLEN_LEVEL__UNESTIMATED";return this.transloco.translate(`pollen.${i}`)}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(y.Vn,16))},t.\u0275pipe=e.Yjl({name:"pollenLevel",type:t,pure:!0}),t})();const pe=function(t,r,n,i){return{"text-red-500":t,"text-orange-500":r,"text-yellow-500":n,"text-green-500":i}};function ve(t,r){if(1&t&&(e.TgZ(0,"tui-island",1),e.TgZ(1,"h3",2),e._uU(2),e.qZA(),e.TgZ(3,"div",3),e.TgZ(4,"figure",4),e._UZ(5,"tui-avatar",5),e.qZA(),e.TgZ(6,"div"),e.TgZ(7,"p",2),e._uU(8),e.qZA(),e.qZA(),e.TgZ(9,"div"),e.TgZ(10,"p",6),e._uU(11),e.ALo(12,"pollenLevel"),e._UZ(13,"tui-tooltip",7),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t){const n=r.$implicit,i=e.oxw();e.Q6J("hoverable",!0),e.xp6(2),e.Oqu(n(i.metric.name)),e.xp6(3),e.Q6J("avatarUrl",i.metric.icon),e.xp6(3),e.Oqu(i.metric.value.units),e.xp6(2),e.Q6J("ngClass",e.l5B(9,pe,"very_high"===i.metric.value.level,"high"===i.metric.value.level,"medium"===i.metric.value.level,"low"===i.metric.value.level)),e.xp6(1),e.hij(" ",e.lcZ(12,7,i.metric.value.level)," "),e.xp6(2),e.Q6J("content",i.metric.value.count+" gp/m\xb3")}}let F=(()=>{class t{constructor(){}ngOnInit(){this.setConfig()}setConfig(){const{name:n,icon:i}=L.Yw.get(this.entry.value.type)||{icon:"assets/img/trees/tree-placeholder.png",name:"UNKNOWN__NAME",type:"unknown"};this.metric={icon:i,name:n,value:{count:this.entry.value.polllenGrains.count,units:this.entry.value.polllenGrains.units,level:this.entry.value.polllenGrains.level}}}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["polenmad-metric-card"]],inputs:{entry:"entry"},decls:1,vars:1,consts:[["size","l","textAlign","center",3,"hoverable",4,"transloco","translocoRead"],["size","l","textAlign","center",3,"hoverable"],[1,"tui-island__title"],[1,"tui-island__content"],[1,"tui-island__figure"],[3,"avatarUrl"],[1,"tui-island__title",3,"ngClass"],["direction","right","size","s",3,"content"]],template:function(n,i){1&n&&e.YNc(0,ve,14,14,"tui-island",0),2&n&&e.Q6J("translocoRead","pollen")},directives:[y.KI,Z,le,p.mk,E.w],pipes:[B],styles:[""],changeDetection:0}),t})();function ge(t,r){1&t&&e._UZ(0,"polenmad-metric-card",5),2&t&&e.Q6J("entry",r.$implicit)}function fe(t,r){if(1&t&&(e.TgZ(0,"div",2),e.TgZ(1,"h1"),e._uU(2),e.qZA(),e.TgZ(3,"div",3),e.YNc(4,ge,1,1,"polenmad-metric-card",4),e.qZA(),e.qZA()),2&t){const n=r.$implicit,i=e.oxw().ngIf;e.xp6(2),e.Oqu(n("METRICS__TITLE")),e.xp6(2),e.Q6J("ngForOf",i)}}function he(t,r){1&t&&(e.ynx(0),e.YNc(1,fe,5,2,"div",1),e.BQk()),2&t&&(e.xp6(1),e.Q6J("translocoRead","pollen"))}class m{constructor(r){this.store=r}ngOnInit(){this.store.dispatch(new I)}}m.\u0275fac=function(r){return new(r||m)(e.Y36(h.yh))},m.\u0275cmp=e.Xpm({type:m,selectors:[["polenmad-metrics-layout"]],decls:2,vars:3,consts:[[4,"ngIf"],["class","container mx-auto px-4",4,"transloco","translocoRead"],[1,"container","mx-auto","px-4"],[1,"grid","grid-cols-2","gap-4"],[3,"entry",4,"ngFor","ngForOf"],[3,"entry"]],template:function(r,n){1&r&&(e.YNc(0,he,2,1,"ng-container",0),e.ALo(1,"async")),2&r&&e.Q6J("ngIf",e.lcZ(1,1,n.alergies$))},directives:[p.O5,y.KI,p.sg,F],pipes:[p.Ov],styles:[""],changeDetection:0}),(0,c.gn)([(0,h.Ph)(u.alergies),(0,c.w6)("design:type",T.y)],m.prototype,"alergies$",void 0);const me=[{path:"",component:m}];let ye=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[z.Bz.forChild(me)],z.Bz]}),t})();const Me=[H,ue,E.Q],Te=[(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[p.ez,...Me,y.y4]]}),t})()];let Ie=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[[p.ez,...Te,h.$l.forFeature([u]),ye,y.y4]]}),t})()}}]);